{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nexport const authGuard = (route, state) => {\n  const router = inject(Router);\n  const token = localStorage.getItem('token');\n  // Require authentication\n  if (!token) {\n    // Redirect to login with return URL\n    return router.parseUrl(`/auth?mode=login&returnUrl=${encodeURIComponent(state.url)}`);\n  }\n  // Optional role-based access control\n  const allowedRoles = route.data?.['roles'];\n  if (allowedRoles && allowedRoles.length > 0) {\n    const userRole = localStorage.getItem('userRole');\n    if (!userRole || !allowedRoles.includes(userRole)) {\n      // If role mismatch, redirect to home or an unauthorized page\n      return router.parseUrl('/');\n    }\n  }\n  return true;\n};","map":{"version":3,"names":["inject","Router","authGuard","route","state","router","token","localStorage","getItem","parseUrl","encodeURIComponent","url","allowedRoles","data","length","userRole","includes"],"sources":["/Users/manideepgonugunta/Desktop/internship/skillforge/skillforge1/frontend/src/app/auth/auth.guard.ts"],"sourcesContent":["import { inject } from '@angular/core';\nimport { CanActivateFn, Router, UrlTree } from '@angular/router';\n\n\nexport const authGuard: CanActivateFn = (route, state): boolean | UrlTree => {\n  const router = inject(Router);\n  const token = localStorage.getItem('token');\n\n  // Require authentication\n  if (!token) {\n    // Redirect to login with return URL\n    return router.parseUrl(`/auth?mode=login&returnUrl=${encodeURIComponent(state.url)}`);\n  }\n\n  // Optional role-based access control\n  const allowedRoles = route.data?.['roles'] as string[] | undefined;\n  if (allowedRoles && allowedRoles.length > 0) {\n    const userRole = localStorage.getItem('userRole');\n    if (!userRole || !allowedRoles.includes(userRole)) {\n      // If role mismatch, redirect to home or an unauthorized page\n      return router.parseUrl('/');\n    }\n  }\n\n  return true;\n};\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,eAAe;AACtC,SAAwBC,MAAM,QAAiB,iBAAiB;AAGhE,OAAO,MAAMC,SAAS,GAAkBA,CAACC,KAAK,EAAEC,KAAK,KAAuB;EAC1E,MAAMC,MAAM,GAAGL,MAAM,CAACC,MAAM,CAAC;EAC7B,MAAMK,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAE3C;EACA,IAAI,CAACF,KAAK,EAAE;IACV;IACA,OAAOD,MAAM,CAACI,QAAQ,CAAC,8BAA8BC,kBAAkB,CAACN,KAAK,CAACO,GAAG,CAAC,EAAE,CAAC;;EAGvF;EACA,MAAMC,YAAY,GAAGT,KAAK,CAACU,IAAI,GAAG,OAAO,CAAyB;EAClE,IAAID,YAAY,IAAIA,YAAY,CAACE,MAAM,GAAG,CAAC,EAAE;IAC3C,MAAMC,QAAQ,GAAGR,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IACjD,IAAI,CAACO,QAAQ,IAAI,CAACH,YAAY,CAACI,QAAQ,CAACD,QAAQ,CAAC,EAAE;MACjD;MACA,OAAOV,MAAM,CAACI,QAAQ,CAAC,GAAG,CAAC;;;EAI/B,OAAO,IAAI;AACb,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}